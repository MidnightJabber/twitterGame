$(document).ready(function(){function e(e,t,n){var a="";a='<table class="gameTable">\n',a+="    <thead>\n",a+="        <tr>\n",a+="            <th>\nUser</th>\n",a+="            <th>\nTweet</th>\n",a+="        </tr>\n",a+="    </thead>\n",a+="    <tbody>\n",$.each(e[t],function(e,t){tweetHTML=twemoji.parse(t.tweetInfo.tweetHTML),a+="        <tr>\n",a+="            <td>\n",a+='                <div class="userCard">\n',a+='                    <div class="userImg">\n',a=a+'                        <a href="https://twitter.com/'+t.userInfo.handle.substring(1)+'" target="_blank"><img src="'+t.userInfo.profilePicURL+'"></a>\n',a+="                    </div>\n",a+='                    <div class="userInfo">\n',a=a+'                        <div class="userName">'+t.userInfo.name+"</div>\n",a=a+'                        <div class="userHandle">'+t.userInfo.handle+"</div>\n",a+="                    </div>\n",a=a+'                    <a class="followButton" href="'+t.userInfo.followURL+'" target="_blank">\n',a+='                        <span class="fa fa-twitter"></span>\n',a+='                        <p class="text">Follow</p>\n',a+="                    </a>\n",a+="                </div>\n",a+="            </td>\n",a+="            <td>\n",a+='                <div class="tweetCard">\n',a+=tweetHTML,a+="                </div>\n",a+="            </td>\n",a+="        </tr>\n"}),a+="    </tbody>\n",a+="</table>\n",$(n).append(a)}function t(e,t){C=e.find(".userInfo").find(".userHandle")[0].innerHTML.replace("@",""),y=t.parent("td").siblings("td").find(".userCard").find(".userInfo").find(".userHandle")[0].innerHTML.replace("@",""),I[C].tweetInfo.tweetID==S[y].tweetInfo.tweetID?($("table").trigger("correct-selection"),T.toggleClass("correctSelection"),k.toggleClass("correctSelection"),L+=C,M+=y):($("table").trigger("incorrect-selection"),T.toggleClass("incorrectSelection"),k.toggleClass("incorrectSelection"),T.toggleClass("shake shake-horzontal"),k.toggleClass("shake shake-horzontal")),T.toggleClass("selectedCard"),k.toggleClass("selectedCard"),T=void 0,k=void 0,H=!1,x=!1}function n(e,t,n){var a=$.extend(!0,{},t),o=$.extend(!0,{},n);setTimeout(function(){a.toggleClass("correctSelectionAnimation"),o.toggleClass("correctSelectionAnimation")},e)}function a(e,t,n){var a=$.extend(!0,{},t),o=$.extend(!0,{},n);setTimeout(function(){a.toggleClass("incorrectSelection"),o.toggleClass("incorrectSelection"),a.toggleClass("shake shake-horzontal"),o.toggleClass("shake shake-horzontal")},e)}function o(e){var t=50+Math.floor(Math.pow(1.05,e)*O),n=G;return G+=t,n=G-n,G}function s(){var e="";$.ajax({url:j,type:"POST",async:!1,beforeSend:function(e,t){(t.url!=A||G>18e3||w)&&e.abort()},success:function(e){}}),e+='<div class="endInfo">',e+='    <div class="finalScore">',e=e+"        <p>Your Score:<span>"+G+"</span></p>",e+="    </div>",e+='    <div class="attempts">',e+='        <div class="correct">',e=e+"            <p>Correct Attempts: "+O+"</p>",e+="        </div>",e+='        <div class="incorrect">',e=e+"            <p>Incorrect Attempts: "+_+"</p>",e+="        </div>",e+="    </div>",e+='    <div class="survey">',e+='        <a href="https://tweetysurvey.typeform.com/to/m1GIH1" target="_blank"><p>Please take our survey to make this game better</p></a>',e+="    </div>",e+='    <div class="buttons">',e+='        <button class="answers">Answers</button>',e+='        <button class="playAgain">Play Again</button>',e+="    </div>",e+='    <div class="leaderboard">',e+="    </div>",e+='    <div class="answerTable">',e+="    </div>",e+="</div>",$("body").append(e),i(5)}function r(e){var t=$(".timer").TimeCircles().getTime();if(t=Math.floor(t-e),0>=t){var n=$.Event("endGame");n._all=!1,n.timeLeft=0,$("body").trigger(n)}else $(".timer").data("timer",t).TimeCircles().restart()}function i(e){var t;$.ajax({url:"http://tweety.midnightjabber.com/php/scoreQueries.php?query=get_top_players&count="+e,type:"GET",async:!1,success:function(e){t=JSON.parse(e)}});var n="";n='<table class="leaderboardTable">\n',n+="    <thead>\n",n+="        <tr>\n",n+="            <th>\nRank</th>\n",n+="            <th>\nImage</th>\n",n+="            <th>\nName</th>\n",n+="            <th>\nScore</th>\n",n+="        </tr>\n",n+="    </thead>\n",n+="    <tbody>\n",$.each(t,function(e,t){n+="        <tr>\n",n+="            <td>\n",n=n+'                <p class="rank">'+e+"</p>\n",n+="            </td>\n",n+="            <td>\n",n=n+'                <img class="playerImage" src="http://'+t.profilePic+'">\n',n+="            </td>\n",n+="            <td>\n",n=n+'                <p class="playerName">'+t.playerName+"</p>\n",n+="            </td>\n",n+="            <td>\n",n=n+'                <p class="leaderboardScore">'+t.score+"</p>\n",n+="            </td>\n",n+="        </tr>\n"}),n+="    </tbody>\n",n+="</table>\n",$(".leaderboard").append(n)}function l(e){$(".timer").data("timer",e).TimeCircles({total_duration:e,count_past_zero:!1,use_background:!1,animation:"ticks",time:{Days:{show:!1},Hours:{show:!1},Minutes:{show:!1},Seconds:{text:"Seconds",color:"#00B200",show:!0}}}).start().addListener(function(e,t,n){var a;if(0==n){var o=$.Event("endGame");o._all=!1,o.timeLeft=n,$("body").trigger(o)}else 30>=n?a="#E60000":75>=n&&(a="#FFFF5C");$(".timer").TimeCircles({time:{Seconds:{color:a}}})})}function c(){j+="&name='anonymous'",A=j}function d(){j=j+"&timeRemaining="+N,A=j}function g(){j=j+"&score="+G,A=j}function u(){j=j+"&correct="+O,A=j}function f(){j=j+"&incorrect="+_,A=j}function p(){j=j+"&profile_pic='"+E[Math.floor(5*Math.random())]+"'",A=j}function m(){var e="";$.ajax({url:"http://jsonip.com?callback=",type:"GET",async:!1,success:function(t){e=t.ip,j=j+"&ipAddress='"+e+"'",A=j,console.log(A)}})}var v,b=0,h=0,w=!1;$.ajax({url:"php/gameObject.php",type:"GET",async:!1,success:function(e){v=JSON.parse(e)}}),$(".startButton").on("click",function(t){$(document).trigger("startGame"),e(v,"incorrect",".addTableHere"),b=$.now()}),$(document).on("startGame",function(e){$(".startButton").remove(),$(".guide").remove(),$("table").fadeIn("slow"),l(121)});var C,y,T,k,I=v.correct,S=v.incorrect,H=!1,x=!1,L="",M="",O=0,_=0,G=0,N=0,j="php/scoreQueries.php?query=record_score",A="";$(".linkOne").on("click",function(e){$(this).siblings(".imgOne").slideToggle("fast"),$(this).siblings(".imgTwo").hide()}),$(".linkTwo").on("click",function(){$(this).siblings(".imgTwo").slideToggle("fast"),$(this).siblings(".imgOne").hide()}),$(".addTableHere, body").on("click",".linkOne",function(e){$(this).siblings(".imgOne").slideToggle("fast"),$(this).siblings(".imgTwo").hide()}),$(".addTableHere, body").on("click",".linkTwo",function(){$(this).siblings(".imgTwo").slideToggle("fast"),$(this).siblings(".imgOne").hide()}),$("body").on("click",function(e){var t=e.target.localName;("body"==t||"td"==t)&&(void 0!=T&&(T.removeClass("selectedCard incorrectSelection"),T=void 0,H=!1),void 0!=k&&(k.removeClass("selectedCard incorrectSelection"),k=void 0,x=!1))}),$(".addTableHere").on("click",".userCard",function(e){var n=e.target.className,a=e.target.localName,o=$(this),s=o.find(".userInfo").find(".userHandle")[0].innerHTML.replace("@","");L.indexOf(s)>=0||a.indexOf("img")>=0||n.indexOf("followButton")>=0||(void 0==T?(T=$(this),T.toggleClass("selectedCard"),H=!0):o[0]===T[0]?(T.toggleClass("selectedCard"),T=void 0,H=!1):(T.toggleClass("selectedCard"),T=$(this),T.toggleClass("selectedCard"),H=!0),x&&t(T,k))}),$(".addTableHere").on("click",".tweetCard",function(e){var n=(e.target.className,$(this)),a=n.parent("td").siblings("td").find(".userCard").find(".userInfo").find(".userHandle")[0].innerHTML.replace("@","");M.indexOf(a)>=0||(void 0==k?(k=$(this),k.toggleClass("selectedCard"),x=!0):n[0]===k[0]?(k.toggleClass("selectedCard"),k=void 0,x=!1):(k.toggleClass("selectedCard"),k=$(this),k.toggleClass("selectedCard"),x=!0),H&&t(T,k))}),$(".addTableHere, .answerTable").on("click",".imgLink",function(e){e.stopPropagation()}),$(".addTableHere, .answerTable").on("click","td a",function(e){e.stopPropagation()}),$("body").on("incorrect-selection","table",function(e){r(10),$(".incorrectSound").trigger("play"),_+=1,a(500,T,k)}),$("body").on("correct-selection","table",function(e){if(O+=1,10===O){var t=$.Event("endGame");t._all=!0,t.timeLeft=$(".timer").TimeCircles().getTime(),$("body").trigger(t)}$(".correctSound").trigger("play"),n(0,T,k);var a=$(".timer").TimeCircles().getTime();$(".score").text(o(a))}),$("body").on("endGame",function(e){h=$.now(),h-b>13e4&&(w=!0),N=Math.floor(e.timeLeft),G+=Math.floor(20*e.timeLeft),$("table").remove(),$(".timer").TimeCircles().destroy(),$(".timer").remove(),$(".score").remove(),c(),d(),g(),u(),f(),m(),p(),s()}),$("body").on("click",".answers",function(t){e(v,"correct",".answerTable"),$(".answers").remove(),$(".answerTable table").css("box-shadow","0 0 30px -5px rgba(0,0,0,0.4)"),$(".answerTable table").fadeIn("slow"),$(".answerTable table thead th").empty()}),$("body").on("click",".playAgain",function(e){location.reload()}),$("body").on("click",".logoImg",function(e){location.reload()});var E=["www.lovemarks.com/wp-content/uploads/profile-avatars/default-avatar-bad-werewolf.png","www.lovemarks.com/wp-content/uploads/profile-avatars/default-avatar-knives-ninja.png","www.lovemarks.com/wp-content/uploads/profile-avatars/default-avatar-foxy-fox.png","www.lovemarks.com/wp-content/uploads/profile-avatars/default-avatar-ponsy-deer.png","www.lovemarks.com/wp-content/uploads/profile-avatars/default-avatar-nerd-pug.png"]});